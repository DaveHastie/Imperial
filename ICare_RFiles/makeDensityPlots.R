require(profRegr)
load('~/iCare/RAnalysis/allMAllMainPY1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/allMAllMainPY1.RData")

denObj<-vector(mode='list')
maxX<-0
maxY<-0
for(i in 2:85){
   denObj[[i]]<-density(predObj$RRPerSweep[,i])
   maxX<-max(maxX,denObj[[i]]$x)
   maxY<-max(maxY,denObj[[i]]$y)
}
png('~/iCare/plots/allMAllMainPY_predictDensFixCT.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
#maxX<-max(maxXVec[9],maxXVec[25],maxXVec[41],maxXVec[57])
#maxY<-max(maxYVec[9],maxYVec[25],maxYVec[41],maxYVec[57])
plot(denObj[[9]]$x,denObj[[9]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=4',type='l')
lines(denObj[[25]]$x,denObj[[25]]$y,col='blue')
lines(denObj[[41]]$x,denObj[[41]]$y,col='gold')
lines(denObj[[57]]$x,denObj[[57]]$y,col='red')
#maxX<-max(maxXVec[13],maxXVec[29],maxXVec[45],maxXVec[61])
#maxY<-max(maxYVec[13],maxYVec[29],maxYVec[45],maxYVec[61])
plot(denObj[[13]]$x,denObj[[13]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[29]]$x,denObj[[29]]$y,col='blue')
lines(denObj[[45]]$x,denObj[[45]]$y,col='gold')
lines(denObj[[61]]$x,denObj[[61]]$y,col='red')
#maxX<-max(maxXVec[17],maxXVec[33],maxXVec[49],maxXVec[65])
#maxY<-max(maxYVec[17],maxYVec[33],maxYVec[49],maxYVec[65])
plot(denObj[[17]]$x,denObj[[17]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[33]]$x,denObj[[33]]$y,col='blue')
lines(denObj[[49]]$x,denObj[[49]]$y,col='gold')
lines(denObj[[65]]$x,denObj[[65]]$y,col='red')
#maxX<-max(maxXVec[21],maxXVec[37],maxXVec[53],maxXVec[69])
#maxY<-max(maxYVec[21],maxYVec[37],maxYVec[53],maxYVec[69])
plot(denObj[[21]]$x,denObj[[21]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[37]]$x,denObj[[37]]$y,col='blue')
lines(denObj[[53]]$x,denObj[[53]]$y,col='gold')
lines(denObj[[69]]$x,denObj[[69]]$y,col='red')
#maxX<-max(maxXVec[8],maxXVec[24],maxXVec[40],maxXVec[56])
#maxY<-max(maxYVec[8],maxYVec[24],maxYVec[40],maxYVec[56])
plot(denObj[[8]]$x,denObj[[8]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=3',type='l')
lines(denObj[[24]]$x,denObj[[24]]$y,col='blue')
lines(denObj[[40]]$x,denObj[[40]]$y,col='gold')
lines(denObj[[56]]$x,denObj[[56]]$y,col='red')
#maxX<-max(maxXVec[12],maxXVec[28],maxXVec[44],maxXVec[60])
#maxY<-max(maxYVec[12],maxYVec[28],maxYVec[44],maxYVec[60])
plot(denObj[[12]]$x,denObj[[12]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[28]]$x,denObj[[28]]$y,col='blue')
lines(denObj[[44]]$x,denObj[[44]]$y,col='gold')
lines(denObj[[60]]$x,denObj[[60]]$y,col='red')
#maxX<-max(maxXVec[16],maxXVec[32],maxXVec[48],maxXVec[64])
#maxY<-max(maxYVec[16],maxYVec[32],maxYVec[48],maxYVec[64])
plot(denObj[[16]]$x,denObj[[16]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[32]]$x,denObj[[32]]$y,col='blue')
lines(denObj[[48]]$x,denObj[[48]]$y,col='gold')
lines(denObj[[64]]$x,denObj[[64]]$y,col='red')
#maxX<-max(maxXVec[20],maxXVec[36],maxXVec[52],maxXVec[68])
#maxY<-max(maxYVec[20],maxYVec[36],maxYVec[52],maxYVec[68])
plot(denObj[[20]]$x,denObj[[20]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[36]]$x,denObj[[36]]$y,col='blue')
lines(denObj[[52]]$x,denObj[[52]]$y,col='gold')
lines(denObj[[68]]$x,denObj[[68]]$y,col='red')
#maxX<-max(maxXVec[7],maxXVec[23],maxXVec[39],maxXVec[55])
#maxY<-max(maxYVec[7],maxYVec[23],maxYVec[39],maxYVec[55])
plot(denObj[[7]]$x,denObj[[7]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=2',type='l')
lines(denObj[[23]]$x,denObj[[23]]$y,col='blue')
lines(denObj[[39]]$x,denObj[[39]]$y,col='gold')
lines(denObj[[55]]$x,denObj[[55]]$y,col='red')
#maxX<-max(maxXVec[11],maxXVec[27],maxXVec[43],maxXVec[59])
#maxY<-max(maxYVec[11],maxYVec[27],maxYVec[43],maxYVec[59])
plot(denObj[[11]]$x,denObj[[11]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[27]]$x,denObj[[27]]$y,col='blue')
lines(denObj[[43]]$x,denObj[[43]]$y,col='gold')
lines(denObj[[59]]$x,denObj[[59]]$y,col='red')
#maxX<-max(maxXVec[15],maxXVec[31],maxXVec[47],maxXVec[63])
#maxY<-max(maxYVec[15],maxYVec[31],maxYVec[47],maxYVec[63])
plot(denObj[[15]]$x,denObj[[15]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[31]]$x,denObj[[31]]$y,col='blue')
lines(denObj[[47]]$x,denObj[[47]]$y,col='gold')
lines(denObj[[63]]$x,denObj[[63]]$y,col='red')
#maxX<-max(maxXVec[19],maxXVec[35],maxXVec[51],maxXVec[67])
#maxY<-max(maxYVec[19],maxYVec[35],maxYVec[51],maxYVec[67])
plot(denObj[[19]]$x,denObj[[19]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[35]]$x,denObj[[35]]$y,col='blue')
lines(denObj[[51]]$x,denObj[[51]]$y,col='gold')
lines(denObj[[67]]$x,denObj[[67]]$y,col='red')
#maxX<-max(maxXVec[6],maxXVec[22],maxXVec[38],maxXVec[54])
#maxY<-max(maxYVec[6],maxYVec[22],maxYVec[38],maxYVec[54])
plot(denObj[[6]]$x,denObj[[6]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=1',ylab='Duration=1',type='l')
lines(denObj[[22]]$x,denObj[[22]]$y,col='blue')
lines(denObj[[38]]$x,denObj[[38]]$y,col='gold')
lines(denObj[[54]]$x,denObj[[54]]$y,col='red')
#maxX<-max(maxXVec[10],maxXVec[26],maxXVec[42],maxXVec[58])
#maxY<-max(maxYVec[10],maxYVec[26],maxYVec[42],maxYVec[58])
plot(denObj[[10]]$x,denObj[[10]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=2',ylab='',type='l')
lines(denObj[[26]]$x,denObj[[26]]$y,col='blue')
lines(denObj[[42]]$x,denObj[[42]]$y,col='gold')
lines(denObj[[58]]$x,denObj[[58]]$y,col='red')
#maxX<-max(maxXVec[14],maxXVec[30],maxXVec[46],maxXVec[62])
#maxY<-max(maxYVec[14],maxYVec[30],maxYVec[46],maxYVec[62])
plot(denObj[[14]]$x,denObj[[14]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=3',ylab='',type='l')
lines(denObj[[30]]$x,denObj[[30]]$y,col='blue')
lines(denObj[[46]]$x,denObj[[46]]$y,col='gold')
lines(denObj[[62]]$x,denObj[[62]]$y,col='red')
#maxX<-max(maxXVec[18],maxXVec[34],maxXVec[50],maxXVec[66])
#maxY<-max(maxYVec[18],maxYVec[34],maxYVec[50],maxYVec[66])
plot(denObj[[18]]$x,denObj[[18]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=4',ylab='',type='l')
lines(denObj[[34]]$x,denObj[[34]]$y,col='blue')
lines(denObj[[50]]$x,denObj[[50]]$y,col='gold')
lines(denObj[[66]]$x,denObj[[66]]$y,col='red')
dev.off()

png('~/iCare/plots/allMAllMainPY_predictDensMissingCT.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
plot(denObj[[73]]$x,denObj[[73]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='Duration=4',type='l')
plot(denObj[[77]]$x,denObj[[77]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[81]]$x,denObj[[81]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[85]]$x,denObj[[85]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[72]]$x,denObj[[72]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='Duration=3',type='l')
plot(denObj[[76]]$x,denObj[[76]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[80]]$x,denObj[[80]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[84]]$x,denObj[[84]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[71]]$x,denObj[[71]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='Duration=2',type='l')
plot(denObj[[75]]$x,denObj[[75]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[79]]$x,denObj[[79]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[83]]$x,denObj[[83]]$y,xlim=c(0,maxX),xlab='',ylim=c(0,maxY),ylab='',type='l')
plot(denObj[[70]]$x,denObj[[70]]$y,xlim=c(0,maxX),xlab='Intensity=1',ylim=c(0,maxY),ylab='Duration=1',type='l')
plot(denObj[[74]]$x,denObj[[74]]$y,xlim=c(0,maxX),xlab='Intensity=2',ylim=c(0,maxY),type='l')
plot(denObj[[78]]$x,denObj[[78]]$y,xlim=c(0,maxX),xlab='Intensity=3',ylim=c(0,maxY),type='l')
plot(denObj[[82]]$x,denObj[[82]]$y,xlim=c(0,maxX),xlab='Intensity=4',ylim=c(0,maxY),type='l')
dev.off()

#predObj1<-predObj
#denObj1<-denObj
#load('~/iCare/RAnalysis/allMAllMainPY2.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/allMAllMainPY2.RData")
#predObj2<-predObj
#denObj2<-vector(mode='list')
#for(i in 2:85){
#   denObj2[[i]]<-density(predObj2$RRPerSweep[predObj2$RRPerSweep[,i]<quantile(predObj2$RRPerSweep[,i],0.95),i])
#}

#png('~/iCare/plots/allMAllMainPY_predictDensMissingCTStability.png',width=1200,height=800)
#par(mfrow=c(4,4),mar=c(3,3,1,1))
#plot(denObj1[[73]]$x,denObj1[[73]]$y,xlim=c(0,maxXVec[73]),xlab='',ylab='Duration=4',type='l')
#lines(denObj2[[73]]$x,denObj2[[73]]$y,col='blue')
#plot(denObj1[[77]]$x,denObj1[[77]]$y,xlim=c(0,maxXVec[77]),xlab='',ylab='',type='l')
#lines(denObj2[[77]]$x,denObj2[[77]]$y,col='blue')
#plot(denObj1[[81]]$x,denObj1[[81]]$y,xlim=c(0,maxXVec[81]),xlab='',ylab='',type='l')
#lines(denObj2[[81]]$x,denObj2[[81]]$y,col='blue')
#plot(denObj1[[85]]$x,denObj1[[85]]$y,xlim=c(0,maxXVec[85]),xlab='',ylab='',type='l')
#lines(denObj2[[85]]$x,denObj2[[85]]$y,col='blue')
#plot(denObj1[[72]]$x,denObj1[[72]]$y,xlim=c(0,maxXVec[72]),xlab='',ylab='Duration=3',type='l')
#lines(denObj2[[72]]$x,denObj2[[72]]$y,col='blue')
#plot(denObj1[[76]]$x,denObj1[[76]]$y,xlim=c(0,maxXVec[76]),xlab='',ylab='',type='l')
#lines(denObj2[[76]]$x,denObj2[[76]]$y,col='blue')
#plot(denObj1[[80]]$x,denObj1[[80]]$y,xlim=c(0,maxXVec[80]),xlab='',ylab='',type='l')
#lines(denObj2[[80]]$x,denObj2[[80]]$y,col='blue')
#plot(denObj1[[84]]$x,denObj1[[84]]$y,xlim=c(0,maxXVec[84]),xlab='',ylab='',type='l')
#lines(denObj2[[84]]$x,denObj2[[84]]$y,col='blue')
#plot(denObj1[[71]]$x,denObj1[[71]]$y,xlim=c(0,maxXVec[71]),xlab='',ylab='Duration=2',type='l')
#lines(denObj2[[71]]$x,denObj2[[71]]$y,col='blue')
#plot(denObj1[[75]]$x,denObj1[[75]]$y,xlim=c(0,maxXVec[75]),xlab='',ylab='',type='l')
#lines(denObj2[[75]]$x,denObj2[[75]]$y,col='blue')
#plot(denObj1[[79]]$x,denObj1[[79]]$y,xlim=c(0,maxXVec[79]),xlab='',ylab='',type='l')
#lines(denObj2[[79]]$x,denObj2[[79]]$y,col='blue')
#plot(denObj1[[83]]$x,denObj1[[83]]$y,xlim=c(0,maxXVec[83]),xlab='',ylab='',type='l')
#lines(denObj2[[83]]$x,denObj2[[83]]$y,col='blue')
#plot(denObj1[[70]]$x,denObj1[[70]]$y,xlim=c(0,maxXVec[69]),xlab='Intensity=1',ylab='Duration=1',type='l')
#lines(denObj2[[70]]$x,denObj2[[70]]$y,col='blue')
#plot(denObj1[[74]]$x,denObj1[[74]]$y,xlim=c(0,maxXVec[74]),xlab='Intensity=2',type='l')
#lines(denObj2[[74]]$x,denObj2[[74]]$y,col='blue')
#plot(denObj1[[78]]$x,denObj1[[78]]$y,xlim=c(0,maxXVec[78]),xlab='Intensity=3',type='l')
#lines(denObj2[[78]]$x,denObj2[[78]]$y,col='blue')
#plot(denObj1[[82]]$x,denObj1[[82]]$y,xlim=c(0,maxXVec[82]),xlab='Intensity=4',type='l')
#lines(denObj2[[82]]$x,denObj2[[82]]$y,col='blue')
#dev.off()

load('~/iCare/RAnalysis/allMAllMainPYDarkNonFilter1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/allMAllMainPYDarkNonFilter1.RData")

denObj<-vector(mode='list')
maxXVec<-rep(0,85)
maxYVec<-rep(0,85)
for(i in 2:85){
   denObj[[i]]<-density(predObj$RRPerSweep[predObj$RRPerSweep[,i]<quantile(predObj$RRPerSweep[,i],0.95),i])
   maxXVec[i]<-25#quantile(predObj$RRPerSweep[,i],0.95)
   maxYVec[i]<-max(denObj[[i]]$y)
}
png('~/iCare/plots/allMAllMainPYDarkNonFilter_predictDensFixCT.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
maxX<-max(maxXVec[9],maxXVec[25],maxXVec[41],maxXVec[57])
maxY<-max(maxYVec[9],maxYVec[25],maxYVec[41],maxYVec[57])
plot(denObj[[9]]$x,denObj[[9]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=4',type='l')
lines(denObj[[25]]$x,denObj[[25]]$y,col='blue')
lines(denObj[[41]]$x,denObj[[41]]$y,col='gold')
lines(denObj[[57]]$x,denObj[[57]]$y,col='red')
maxX<-max(maxXVec[13],maxXVec[29],maxXVec[45],maxXVec[61])
maxY<-max(maxYVec[13],maxYVec[29],maxYVec[45],maxYVec[61])
plot(denObj[[13]]$x,denObj[[13]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[29]]$x,denObj[[29]]$y,col='blue')
lines(denObj[[45]]$x,denObj[[45]]$y,col='gold')
lines(denObj[[61]]$x,denObj[[61]]$y,col='red')
maxX<-max(maxXVec[17],maxXVec[33],maxXVec[49],maxXVec[65])
maxY<-max(maxYVec[17],maxYVec[33],maxYVec[49],maxYVec[65])
plot(denObj[[17]]$x,denObj[[17]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[33]]$x,denObj[[33]]$y,col='blue')
lines(denObj[[49]]$x,denObj[[49]]$y,col='gold')
lines(denObj[[65]]$x,denObj[[65]]$y,col='red')
maxX<-max(maxXVec[21],maxXVec[37],maxXVec[53],maxXVec[69])
maxY<-max(maxYVec[21],maxYVec[37],maxYVec[53],maxYVec[69])
plot(denObj[[21]]$x,denObj[[21]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[37]]$x,denObj[[37]]$y,col='blue')
lines(denObj[[53]]$x,denObj[[53]]$y,col='gold')
lines(denObj[[69]]$x,denObj[[69]]$y,col='red')
maxX<-max(maxXVec[8],maxXVec[24],maxXVec[40],maxXVec[56])
maxY<-max(maxYVec[8],maxYVec[24],maxYVec[40],maxYVec[56])
plot(denObj[[8]]$x,denObj[[8]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=3',type='l')
lines(denObj[[24]]$x,denObj[[24]]$y,col='blue')
lines(denObj[[40]]$x,denObj[[40]]$y,col='gold')
lines(denObj[[56]]$x,denObj[[56]]$y,col='red')
maxX<-max(maxXVec[12],maxXVec[28],maxXVec[44],maxXVec[60])
maxY<-max(maxYVec[12],maxYVec[28],maxYVec[44],maxYVec[60])
plot(denObj[[12]]$x,denObj[[12]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[28]]$x,denObj[[28]]$y,col='blue')
lines(denObj[[44]]$x,denObj[[44]]$y,col='gold')
lines(denObj[[60]]$x,denObj[[60]]$y,col='red')
maxX<-max(maxXVec[16],maxXVec[32],maxXVec[48],maxXVec[64])
maxY<-max(maxYVec[16],maxYVec[32],maxYVec[48],maxYVec[64])
plot(denObj[[16]]$x,denObj[[16]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[32]]$x,denObj[[32]]$y,col='blue')
lines(denObj[[48]]$x,denObj[[48]]$y,col='gold')
lines(denObj[[64]]$x,denObj[[64]]$y,col='red')
maxX<-max(maxXVec[20],maxXVec[36],maxXVec[52],maxXVec[68])
maxY<-max(maxYVec[20],maxYVec[36],maxYVec[52],maxYVec[68])
plot(denObj[[20]]$x,denObj[[20]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[36]]$x,denObj[[36]]$y,col='blue')
lines(denObj[[52]]$x,denObj[[52]]$y,col='gold')
lines(denObj[[68]]$x,denObj[[68]]$y,col='red')
maxX<-max(maxXVec[7],maxXVec[23],maxXVec[39],maxXVec[55])
maxY<-max(maxYVec[7],maxYVec[23],maxYVec[39],maxYVec[55])
plot(denObj[[7]]$x,denObj[[7]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=2',type='l')
lines(denObj[[23]]$x,denObj[[23]]$y,col='blue')
lines(denObj[[39]]$x,denObj[[39]]$y,col='gold')
lines(denObj[[55]]$x,denObj[[55]]$y,col='red')
maxX<-max(maxXVec[11],maxXVec[27],maxXVec[43],maxXVec[59])
maxY<-max(maxYVec[11],maxYVec[27],maxYVec[43],maxYVec[59])
plot(denObj[[11]]$x,denObj[[11]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[27]]$x,denObj[[27]]$y,col='blue')
lines(denObj[[43]]$x,denObj[[43]]$y,col='gold')
lines(denObj[[59]]$x,denObj[[59]]$y,col='red')
maxX<-max(maxXVec[15],maxXVec[31],maxXVec[47],maxXVec[63])
maxY<-max(maxYVec[15],maxYVec[31],maxYVec[47],maxYVec[63])
plot(denObj[[15]]$x,denObj[[15]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[31]]$x,denObj[[31]]$y,col='blue')
lines(denObj[[47]]$x,denObj[[47]]$y,col='gold')
lines(denObj[[63]]$x,denObj[[63]]$y,col='red')
maxX<-max(maxXVec[19],maxXVec[35],maxXVec[51],maxXVec[67])
maxY<-max(maxYVec[19],maxYVec[35],maxYVec[51],maxYVec[67])
plot(denObj[[19]]$x,denObj[[19]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj[[35]]$x,denObj[[35]]$y,col='blue')
lines(denObj[[51]]$x,denObj[[51]]$y,col='gold')
lines(denObj[[67]]$x,denObj[[67]]$y,col='red')
maxX<-max(maxXVec[6],maxXVec[22],maxXVec[38],maxXVec[54])
maxY<-max(maxYVec[6],maxYVec[22],maxYVec[38],maxYVec[54])
plot(denObj[[6]]$x,denObj[[6]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=1',ylab='Duration=1',type='l')
lines(denObj[[22]]$x,denObj[[22]]$y,col='blue')
lines(denObj[[38]]$x,denObj[[38]]$y,col='gold')
lines(denObj[[54]]$x,denObj[[54]]$y,col='red')
maxX<-max(maxXVec[10],maxXVec[26],maxXVec[42],maxXVec[58])
maxY<-max(maxYVec[10],maxYVec[26],maxYVec[42],maxYVec[58])
plot(denObj[[10]]$x,denObj[[10]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=2',ylab='',type='l')
lines(denObj[[26]]$x,denObj[[26]]$y,col='blue')
lines(denObj[[42]]$x,denObj[[42]]$y,col='gold')
lines(denObj[[58]]$x,denObj[[58]]$y,col='red')
maxX<-max(maxXVec[14],maxXVec[30],maxXVec[46],maxXVec[62])
maxY<-max(maxYVec[14],maxYVec[30],maxYVec[46],maxYVec[62])
plot(denObj[[14]]$x,denObj[[14]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=3',ylab='',type='l')
lines(denObj[[30]]$x,denObj[[30]]$y,col='blue')
lines(denObj[[46]]$x,denObj[[46]]$y,col='gold')
lines(denObj[[62]]$x,denObj[[62]]$y,col='red')
maxX<-max(maxXVec[18],maxXVec[34],maxXVec[50],maxXVec[66])
maxY<-max(maxYVec[18],maxYVec[34],maxYVec[50],maxYVec[66])
plot(denObj[[18]]$x,denObj[[18]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=4',ylab='',type='l')
lines(denObj[[34]]$x,denObj[[34]]$y,col='blue')
lines(denObj[[50]]$x,denObj[[50]]$y,col='gold')
lines(denObj[[66]]$x,denObj[[66]]$y,col='red')
dev.off()

png('~/iCare/plots/allMAllMainPYDarkNonFilter_predictDensMissingCT.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
plot(denObj[[73]]$x,denObj[[73]]$y,xlim=c(0,maxXVec[73]),xlab='',ylab='Duration=4',type='l')
plot(denObj[[77]]$x,denObj[[77]]$y,xlim=c(0,maxXVec[77]),xlab='',ylab='',type='l')
plot(denObj[[81]]$x,denObj[[81]]$y,xlim=c(0,maxXVec[81]),xlab='',ylab='',type='l')
plot(denObj[[85]]$x,denObj[[85]]$y,xlim=c(0,maxXVec[85]),xlab='',ylab='',type='l')
plot(denObj[[72]]$x,denObj[[72]]$y,xlim=c(0,maxXVec[72]),xlab='',ylab='Duration=3',type='l')
plot(denObj[[76]]$x,denObj[[76]]$y,xlim=c(0,maxXVec[76]),xlab='',ylab='',type='l')
plot(denObj[[80]]$x,denObj[[80]]$y,xlim=c(0,maxXVec[80]),xlab='',ylab='',type='l')
plot(denObj[[84]]$x,denObj[[84]]$y,xlim=c(0,maxXVec[84]),xlab='',ylab='',type='l')
plot(denObj[[71]]$x,denObj[[71]]$y,xlim=c(0,maxXVec[71]),xlab='',ylab='Duration=2',type='l')
plot(denObj[[75]]$x,denObj[[75]]$y,xlim=c(0,maxXVec[75]),xlab='',ylab='',type='l')
plot(denObj[[79]]$x,denObj[[79]]$y,xlim=c(0,maxXVec[79]),xlab='',ylab='',type='l')
plot(denObj[[83]]$x,denObj[[83]]$y,xlim=c(0,maxXVec[83]),xlab='',ylab='',type='l')
plot(denObj[[70]]$x,denObj[[70]]$y,xlim=c(0,maxXVec[70]),xlab='Intensity=1',ylab='Duration=1',type='l')
plot(denObj[[74]]$x,denObj[[74]]$y,xlim=c(0,maxXVec[74]),xlab='Intensity=2',type='l')
plot(denObj[[78]]$x,denObj[[78]]$y,xlim=c(0,maxXVec[78]),xlab='Intensity=3',type='l')
plot(denObj[[82]]$x,denObj[[82]]$y,xlim=c(0,maxXVec[82]),xlab='Intensity=4',type='l')
dev.off()

load('~/iCare/RAnalysis/allMAllMainPY1.RData')
predObj1<-predObj
load('~/iCare/RAnalysis/allWAllMainPY1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/allWAllMainPY1.RData")
predObj2<-predObj
denObj1<-vector(mode='list')
denObj2<-vector(mode='list')
maxXVec<-rep(0,85)
for(i in 2:85){
   denObj1[[i]]<-density(predObj1$RRPerSweep[predObj1$RRPerSweep[,i]<quantile(predObj1$RRPerSweep[,i],0.95),i])
   denObj2[[i]]<-density(predObj2$RRPerSweep[predObj2$RRPerSweep[,i]<quantile(predObj2$RRPerSweep[,i],0.95),i])
   maxX1<-quantile(predObj1$RRPerSweep[,i],0.95)
   maxY1<-max(denObj1[[i]]$y)
   maxX2<-quantile(predObj2$RRPerSweep[,i],0.95)
   maxY2<-max(denObj2[[i]]$y)
   maxXVec[i]<-25#max(maxX1,maxX2)
   maxYVec[i]<-max(maxY1,maxY2)
}

png('~/iCare/plots/allMainPY_predictDensMenWomen.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
plot(denObj1[[73]]$x,denObj1[[73]]$y,xlim=c(0,maxXVec[73]),ylim=c(0,maxYVec[73]),xlab='',ylab='Duration=4',type='l')
lines(denObj2[[73]]$x,denObj2[[73]]$y,col='red')
plot(denObj1[[77]]$x,denObj1[[77]]$y,xlim=c(0,maxXVec[77]),ylim=c(0,maxYVec[77]),xlab='',ylab='',type='l')
lines(denObj2[[77]]$x,denObj2[[77]]$y,col='red')
plot(denObj1[[81]]$x,denObj1[[81]]$y,xlim=c(0,maxXVec[81]),ylim=c(0,maxYVec[81]),xlab='',ylab='',type='l')
lines(denObj2[[81]]$x,denObj2[[81]]$y,col='red')
plot(denObj1[[85]]$x,denObj1[[85]]$y,xlim=c(0,maxXVec[85]),ylim=c(0,maxYVec[85]),xlab='',ylab='',type='l')
lines(denObj2[[85]]$x,denObj2[[85]]$y,col='red')
plot(denObj1[[72]]$x,denObj1[[72]]$y,xlim=c(0,maxXVec[72]),ylim=c(0,maxYVec[72]),xlab='',ylab='Duration=3',type='l')
lines(denObj2[[72]]$x,denObj2[[72]]$y,col='red')
plot(denObj1[[76]]$x,denObj1[[76]]$y,xlim=c(0,maxXVec[76]),ylim=c(0,maxYVec[76]),xlab='',ylab='',type='l')
lines(denObj2[[76]]$x,denObj2[[76]]$y,col='red')
plot(denObj1[[80]]$x,denObj1[[80]]$y,xlim=c(0,maxXVec[80]),ylim=c(0,maxYVec[80]),xlab='',ylab='',type='l')
lines(denObj2[[80]]$x,denObj2[[80]]$y,col='red')
plot(denObj1[[84]]$x,denObj1[[84]]$y,xlim=c(0,maxXVec[84]),ylim=c(0,maxYVec[84]),xlab='',ylab='',type='l')
lines(denObj2[[84]]$x,denObj2[[84]]$y,col='red')
plot(denObj1[[71]]$x,denObj1[[71]]$y,xlim=c(0,maxXVec[71]),ylim=c(0,maxYVec[71]),xlab='',ylab='Duration=2',type='l')
lines(denObj2[[71]]$x,denObj2[[71]]$y,col='red')
plot(denObj1[[75]]$x,denObj1[[75]]$y,xlim=c(0,maxXVec[75]),ylim=c(0,maxYVec[75]),xlab='',ylab='',type='l')
lines(denObj2[[75]]$x,denObj2[[75]]$y,col='red')
plot(denObj1[[79]]$x,denObj1[[79]]$y,xlim=c(0,maxXVec[79]),ylim=c(0,maxYVec[79]),xlab='',ylab='',type='l')
lines(denObj2[[79]]$x,denObj2[[79]]$y,col='red')
plot(denObj1[[83]]$x,denObj1[[83]]$y,xlim=c(0,maxXVec[83]),ylim=c(0,maxYVec[83]),xlab='',ylab='',type='l')
lines(denObj2[[83]]$x,denObj2[[83]]$y,col='red')
plot(denObj1[[70]]$x,denObj1[[70]]$y,xlim=c(0,maxXVec[70]),ylim=c(0,maxYVec[70]),xlab='Intensity=1',ylab='Duration=1',type='l')
lines(denObj2[[70]]$x,denObj2[[70]]$y,col='red')
plot(denObj1[[74]]$x,denObj1[[74]]$y,xlim=c(0,maxXVec[74]),ylim=c(0,maxYVec[74]),xlab='Intensity=2',type='l')
lines(denObj2[[74]]$x,denObj2[[74]]$y,col='red')
plot(denObj1[[78]]$x,denObj1[[78]]$y,xlim=c(0,maxXVec[78]),ylim=c(0,maxYVec[78]),xlab='Intensity=3',type='l')
lines(denObj2[[78]]$x,denObj2[[78]]$y,col='red')
plot(denObj1[[82]]$x,denObj1[[82]]$y,xlim=c(0,maxXVec[82]),ylim=c(0,maxYVec[82]),xlab='Intensity=4',type='l')
lines(denObj2[[82]]$x,denObj2[[82]]$y,col='red')
dev.off()


load('~/iCare/RAnalysis/allMAllMainPY1.RData')
predObj1<-predObj
load('~/iCare/RAnalysis/EAGLEMAllMainPY1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/EAGLEMAllMainPY1.RData")
predObj2<-predObj
denObj1<-vector(mode='list')
denObj2<-vector(mode='list')
maxXVec<-rep(0,85)
for(i in 2:85){
   denObj1[[i]]<-density(predObj1$RRPerSweep[predObj1$RRPerSweep[,i]<quantile(predObj1$RRPerSweep[,i],0.95),i])
   denObj2[[i]]<-density(predObj2$RRPerSweep[predObj2$RRPerSweep[,i]<quantile(predObj2$RRPerSweep[,i],0.95),i])
   maxX1<-quantile(predObj1$RRPerSweep[,i],0.95)
   maxY1<-max(denObj1[[i]]$y)
   maxX2<-quantile(predObj2$RRPerSweep[,i],0.95)
   maxY2<-max(denObj2[[i]]$y)
   maxXVec[i]<-25#max(maxX1,maxX2)
   maxYVec[i]<-max(maxY1,maxY2)
}

png('~/iCare/plots/allMainPY_predictDensICareEagle.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
plot(denObj1[[73]]$x,denObj1[[73]]$y,xlim=c(0,maxXVec[73]),ylim=c(0,maxYVec[73]),xlab='',ylab='Duration=4',type='l')
lines(denObj2[[73]]$x,denObj2[[73]]$y,col='red')
plot(denObj1[[77]]$x,denObj1[[77]]$y,xlim=c(0,maxXVec[77]),ylim=c(0,maxYVec[77]),xlab='',ylab='',type='l')
lines(denObj2[[77]]$x,denObj2[[77]]$y,col='red')
plot(denObj1[[81]]$x,denObj1[[81]]$y,xlim=c(0,maxXVec[81]),ylim=c(0,maxYVec[81]),xlab='',ylab='',type='l')
lines(denObj2[[81]]$x,denObj2[[81]]$y,col='red')
plot(denObj1[[85]]$x,denObj1[[85]]$y,xlim=c(0,maxXVec[85]),ylim=c(0,maxYVec[85]),xlab='',ylab='',type='l')
lines(denObj2[[85]]$x,denObj2[[85]]$y,col='red')
plot(denObj1[[72]]$x,denObj1[[72]]$y,xlim=c(0,maxXVec[72]),ylim=c(0,maxYVec[72]),xlab='',ylab='Duration=3',type='l')
lines(denObj2[[72]]$x,denObj2[[72]]$y,col='red')
plot(denObj1[[76]]$x,denObj1[[76]]$y,xlim=c(0,maxXVec[76]),ylim=c(0,maxYVec[76]),xlab='',ylab='',type='l')
lines(denObj2[[76]]$x,denObj2[[76]]$y,col='red')
plot(denObj1[[80]]$x,denObj1[[80]]$y,xlim=c(0,maxXVec[80]),ylim=c(0,maxYVec[80]),xlab='',ylab='',type='l')
lines(denObj2[[80]]$x,denObj2[[80]]$y,col='red')
plot(denObj1[[84]]$x,denObj1[[84]]$y,xlim=c(0,maxXVec[84]),ylim=c(0,maxYVec[84]),xlab='',ylab='',type='l')
lines(denObj2[[84]]$x,denObj2[[84]]$y,col='red')
plot(denObj1[[71]]$x,denObj1[[71]]$y,xlim=c(0,maxXVec[71]),ylim=c(0,maxYVec[71]),xlab='',ylab='Duration=2',type='l')
lines(denObj2[[71]]$x,denObj2[[71]]$y,col='red')
plot(denObj1[[75]]$x,denObj1[[75]]$y,xlim=c(0,maxXVec[75]),ylim=c(0,maxYVec[75]),xlab='',ylab='',type='l')
lines(denObj2[[75]]$x,denObj2[[75]]$y,col='red')
plot(denObj1[[79]]$x,denObj1[[79]]$y,xlim=c(0,maxXVec[79]),ylim=c(0,maxYVec[79]),xlab='',ylab='',type='l')
lines(denObj2[[79]]$x,denObj2[[79]]$y,col='red')
plot(denObj1[[83]]$x,denObj1[[83]]$y,xlim=c(0,maxXVec[83]),ylim=c(0,maxYVec[83]),xlab='',ylab='',type='l')
lines(denObj2[[83]]$x,denObj2[[83]]$y,col='red')
plot(denObj1[[70]]$x,denObj1[[70]]$y,xlim=c(0,maxXVec[70]),ylim=c(0,maxYVec[70]),xlab='Intensity=1',ylab='Duration=1',type='l')
lines(denObj2[[70]]$x,denObj2[[70]]$y,col='red')
plot(denObj1[[74]]$x,denObj1[[74]]$y,xlim=c(0,maxXVec[74]),ylim=c(0,maxYVec[74]),xlab='Intensity=2',type='l')
lines(denObj2[[74]]$x,denObj2[[74]]$y,col='red')
plot(denObj1[[78]]$x,denObj1[[78]]$y,xlim=c(0,maxXVec[78]),ylim=c(0,maxYVec[78]),xlab='Intensity=3',type='l')
lines(denObj2[[78]]$x,denObj2[[78]]$y,col='red')
plot(denObj1[[82]]$x,denObj1[[82]]$y,xlim=c(0,maxXVec[82]),ylim=c(0,maxYVec[82]),xlab='Intensity=4',type='l')
lines(denObj2[[82]]$x,denObj2[[82]]$y,col='red')
dev.off()


load('~/iCare/RAnalysis/allMAllMainPYDarkNonFilter1.RData')
predObj1<-predObj
load('~/iCare/RAnalysis/allWAllMainPYDarkNonFilter1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/allWAllMainPYDarkNonFilter1.RData")
predObj2<-predObj
denObj1<-vector(mode='list')
denObj2<-vector(mode='list')
maxX<-rep(0,85)
maxY<-rep(0,85)
for(i in 2:85){
   denObj1[[i]]<-density(predObj1$RRPerSweep[predObj1$RRPerSweep[,i]<quantile(predObj1$RRPerSweep[,i],0.95),i])
   denObj2[[i]]<-density(predObj2$RRPerSweep[predObj2$RRPerSweep[,i]<quantile(predObj2$RRPerSweep[,i],0.95),i])
   maxX1<-quantile(predObj1$RRPerSweep[,i],0.95)
   maxY1<-max(denObj1[[i]]$y)
   maxX2<-quantile(predObj2$RRPerSweep[,i],0.95)
   maxY2<-max(denObj2[[i]]$y)
   maxXVec[i]<-25#max(maxX1,maxX2)
   maxYVec[i]<-max(maxY1,maxY2)
}

png('~/iCare/plots/allMainPYDarkNonFilter_predictDensMenWomen.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
plot(denObj1[[73]]$x,denObj1[[73]]$y,xlim=c(0,maxXVec[73]),ylim=c(0,maxYVec[72]),xlab='',ylab='Duration=4',type='l')
lines(denObj2[[73]]$x,denObj2[[73]]$y,col='red')
plot(denObj1[[77]]$x,denObj1[[77]]$y,xlim=c(0,maxXVec[77]),ylim=c(0,maxYVec[76]),xlab='',ylab='',type='l')
lines(denObj2[[77]]$x,denObj2[[77]]$y,col='red')
plot(denObj1[[81]]$x,denObj1[[81]]$y,xlim=c(0,maxXVec[81]),ylim=c(0,maxYVec[80]),xlab='',ylab='',type='l')
lines(denObj2[[81]]$x,denObj2[[81]]$y,col='red')
plot(denObj1[[85]]$x,denObj1[[85]]$y,xlim=c(0,maxXVec[85]),ylim=c(0,maxYVec[84]),xlab='',ylab='',type='l')
lines(denObj2[[85]]$x,denObj2[[85]]$y,col='red')
plot(denObj1[[72]]$x,denObj1[[72]]$y,xlim=c(0,maxXVec[72]),ylim=c(0,maxYVec[71]),xlab='',ylab='Duration=3',type='l')
lines(denObj2[[72]]$x,denObj2[[72]]$y,col='red')
plot(denObj1[[76]]$x,denObj1[[76]]$y,xlim=c(0,maxXVec[76]),ylim=c(0,maxYVec[75]),xlab='',ylab='',type='l')
lines(denObj2[[76]]$x,denObj2[[76]]$y,col='red')
plot(denObj1[[80]]$x,denObj1[[80]]$y,xlim=c(0,maxXVec[80]),ylim=c(0,maxYVec[79]),xlab='',ylab='',type='l')
lines(denObj2[[80]]$x,denObj2[[80]]$y,col='red')
plot(denObj1[[84]]$x,denObj1[[84]]$y,xlim=c(0,maxXVec[84]),ylim=c(0,maxYVec[83]),xlab='',ylab='',type='l')
lines(denObj2[[84]]$x,denObj2[[84]]$y,col='red')
plot(denObj1[[71]]$x,denObj1[[71]]$y,xlim=c(0,maxXVec[71]),ylim=c(0,maxYVec[70]),xlab='',ylab='Duration=2',type='l')
lines(denObj2[[71]]$x,denObj2[[71]]$y,col='red')
plot(denObj1[[75]]$x,denObj1[[75]]$y,xlim=c(0,maxXVec[75]),ylim=c(0,maxYVec[74]),xlab='',ylab='',type='l')
lines(denObj2[[75]]$x,denObj2[[75]]$y,col='red')
plot(denObj1[[79]]$x,denObj1[[79]]$y,xlim=c(0,maxXVec[79]),ylim=c(0,maxYVec[78]),xlab='',ylab='',type='l')
lines(denObj2[[79]]$x,denObj2[[79]]$y,col='red')
plot(denObj1[[83]]$x,denObj1[[83]]$y,xlim=c(0,maxXVec[83]),ylim=c(0,maxYVec[82]),xlab='',ylab='',type='l')
lines(denObj2[[83]]$x,denObj2[[83]]$y,col='red')
plot(denObj1[[70]]$x,denObj1[[70]]$y,xlim=c(0,maxXVec[70]),ylim=c(0,maxYVec[69]),xlab='Intensity=1',ylab='Duration=1',type='l')
lines(denObj2[[70]]$x,denObj2[[70]]$y,col='red')
plot(denObj1[[74]]$x,denObj1[[74]]$y,xlim=c(0,maxXVec[74]),ylim=c(0,maxYVec[73]),xlab='Intensity=2',type='l')
lines(denObj2[[74]]$x,denObj2[[74]]$y,col='red')
plot(denObj1[[78]]$x,denObj1[[78]]$y,xlim=c(0,maxXVec[78]),ylim=c(0,maxYVec[77]),xlab='Intensity=3',type='l')
lines(denObj2[[78]]$x,denObj2[[78]]$y,col='red')
plot(denObj1[[82]]$x,denObj1[[82]]$y,xlim=c(0,maxXVec[82]),ylim=c(0,maxYVec[81]),xlab='Intensity=4',type='l')
lines(denObj2[[82]]$x,denObj2[[82]]$y,col='red')
dev.off()

load('~/iCare/RAnalysis/allMAllMainPY1.RData')
predObj1<-predObj
load('~/iCare/RAnalysis/allMAllMainPYDarkNonFilter1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/allWAllMainPY1.RData")
predObj2<-predObj
denObj1<-vector(mode='list')
denObj2<-vector(mode='list')
maxX<-rep(0,85)
maxY<-rep(0,85)
for(i in 2:85){
   denObj1[[i]]<-density(predObj1$RRPerSweep[,i])
   denObj2[[i]]<-density(predObj2$RRPerSweep[,i])
   maxX1<-max(denObj1[[i]]$x)
   maxY1<-max(denObj1[[i]]$y)
   maxX1<-max(denObj2[[i]]$x)
   maxY2<-max(denObj2[[i]]$y)
   maxXVec[i]<-25#max(maxX1,maxX2)
   maxYVec[i]<-max(maxY1,maxY2)
}

png('~/iCare/plots/allMainPY_predictDensInclDarkNonFilter.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
plot(denObj1[[73]]$x,denObj1[[73]]$y,xlim=c(0,maxXVec[73]),ylim=c(0,maxYVec[72]),xlab='',ylab='Duration=4',type='l')
lines(denObj2[[73]]$x,denObj2[[73]]$y,col='red')
plot(denObj1[[77]]$x,denObj1[[77]]$y,xlim=c(0,maxXVec[77]),ylim=c(0,maxYVec[76]),xlab='',ylab='',type='l')
lines(denObj2[[77]]$x,denObj2[[77]]$y,col='red')
plot(denObj1[[81]]$x,denObj1[[81]]$y,xlim=c(0,maxXVec[81]),ylim=c(0,maxYVec[80]),xlab='',ylab='',type='l')
lines(denObj2[[81]]$x,denObj2[[81]]$y,col='red')
plot(denObj1[[85]]$x,denObj1[[85]]$y,xlim=c(0,maxXVec[85]),ylim=c(0,maxYVec[84]),xlab='',ylab='',type='l')
lines(denObj2[[85]]$x,denObj2[[85]]$y,col='red')
plot(denObj1[[72]]$x,denObj1[[72]]$y,xlim=c(0,maxXVec[72]),ylim=c(0,maxYVec[71]),xlab='',ylab='Duration=3',type='l')
lines(denObj2[[72]]$x,denObj2[[72]]$y,col='red')
plot(denObj1[[76]]$x,denObj1[[76]]$y,xlim=c(0,maxXVec[76]),ylim=c(0,maxYVec[75]),xlab='',ylab='',type='l')
lines(denObj2[[76]]$x,denObj2[[76]]$y,col='red')
plot(denObj1[[80]]$x,denObj1[[80]]$y,xlim=c(0,maxXVec[80]),ylim=c(0,maxYVec[79]),xlab='',ylab='',type='l')
lines(denObj2[[80]]$x,denObj2[[80]]$y,col='red')
plot(denObj1[[84]]$x,denObj1[[84]]$y,xlim=c(0,maxXVec[84]),ylim=c(0,maxYVec[83]),xlab='',ylab='',type='l')
lines(denObj2[[84]]$x,denObj2[[84]]$y,col='red')
plot(denObj1[[71]]$x,denObj1[[71]]$y,xlim=c(0,maxXVec[71]),ylim=c(0,maxYVec[70]),xlab='',ylab='Duration=2',type='l')
lines(denObj2[[71]]$x,denObj2[[71]]$y,col='red')
plot(denObj1[[75]]$x,denObj1[[75]]$y,xlim=c(0,maxXVec[75]),ylim=c(0,maxYVec[74]),xlab='',ylab='',type='l')
lines(denObj2[[75]]$x,denObj2[[75]]$y,col='red')
plot(denObj1[[79]]$x,denObj1[[79]]$y,xlim=c(0,maxXVec[79]),ylim=c(0,maxYVec[78]),xlab='',ylab='',type='l')
lines(denObj2[[79]]$x,denObj2[[79]]$y,col='red')
plot(denObj1[[83]]$x,denObj1[[83]]$y,xlim=c(0,maxXVec[83]),ylim=c(0,maxYVec[82]),xlab='',ylab='',type='l')
lines(denObj2[[83]]$x,denObj2[[83]]$y,col='red')
plot(denObj1[[70]]$x,denObj1[[70]]$y,xlim=c(0,maxXVec[70]),ylim=c(0,maxYVec[69]),xlab='Intensity=1',ylab='Duration=1',type='l')
lines(denObj2[[70]]$x,denObj2[[70]]$y,col='red')
plot(denObj1[[74]]$x,denObj1[[74]]$y,xlim=c(0,maxXVec[74]),ylim=c(0,maxYVec[73]),xlab='Intensity=2',type='l')
lines(denObj2[[74]]$x,denObj2[[74]]$y,col='red')
plot(denObj1[[78]]$x,denObj1[[78]]$y,xlim=c(0,maxXVec[78]),ylim=c(0,maxYVec[77]),xlab='Intensity=3',type='l')
lines(denObj2[[78]]$x,denObj2[[78]]$y,col='red')
plot(denObj1[[82]]$x,denObj1[[82]]$y,xlim=c(0,maxXVec[82]),ylim=c(0,maxYVec[81]),xlab='Intensity=4',type='l')
lines(denObj2[[82]]$x,denObj2[[82]]$y,col='red')
dev.off()

load('~/iCare/RAnalysis/allMAllMainPYDarkNonFilter1.RData')
predObj1<-predObj
load('~/iCare/RAnalysis/AdMAllMainPYDarkNonFilter1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/AdMAllMainPYDarkNonFilter1.RData")
predObj2<-predObj
load('~/iCare/RAnalysis/SCMAllMainPYDarkNonFilter1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/SCMAllMainPYDarkNonFilter1.RData")
predObj3<-predObj
load('~/iCare/RAnalysis/SqMAllMainPYDarkNonFilter1.RData')
#predObj<-calcPredictions(riskProfObj,doRaoBlackwell=T,fullSweepPredictions=T,fullSweepRR=T)
#save(list=c("runInfoObj","disSimObj","clusObj","riskProfObj","predObj","clusterOrder"),file="~/iCare/RAnalysis/SqMAllMainPYDarkNonFilter1.RData")
predObj4<-predObj
denObj1<-vector(mode='list')
denObj2<-vector(mode='list')
denObj3<-vector(mode='list')
denObj4<-vector(mode='list')
maxX<-0
maxY<-0
for(i in 2:85){
   denObj1[[i]]<-density(predObj1$RRPerSweep[,i])
   denObj2[[i]]<-density(predObj2$RRPerSweep[,i])
   denObj3[[i]]<-density(predObj3$RRPerSweep[,i])
   denObj4[[i]]<-density(predObj4$RRPerSweep[,i])
   maxX<-max(maxX,denObj1[[i]]$x,denObj2[[i]]$x,denObj3[[i]]$x,denObj4[[i]]$x)
   maxY<-max(maxY,denObj1[[i]]$y,denObj2[[i]]$y,denObj3[[i]]$y,denObj4[[i]]$y)
}
maxX<-100
png('~/iCare/plots/allMainPYDarkNonFilter_predictDensHistology.png',width=1200,height=800)
par(mfrow=c(4,4),mar=c(3,3,1,1))
plot(denObj1[[73]]$x,denObj1[[73]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=4',type='l')
lines(denObj2[[73]]$x,denObj2[[73]]$y,col='blue')
lines(denObj3[[73]]$x,denObj3[[73]]$y,col='gold')
lines(denObj4[[73]]$x,denObj4[[73]]$y,col='red')
plot(denObj1[[77]]$x,denObj1[[77]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[77]]$x,denObj2[[77]]$y,col='blue')
lines(denObj3[[77]]$x,denObj3[[77]]$y,col='gold')
lines(denObj4[[77]]$x,denObj4[[77]]$y,col='red')
plot(denObj1[[81]]$x,denObj1[[81]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[81]]$x,denObj2[[81]]$y,col='blue')
lines(denObj3[[81]]$x,denObj3[[81]]$y,col='gold')
lines(denObj4[[81]]$x,denObj4[[81]]$y,col='red')
plot(denObj1[[85]]$x,denObj1[[85]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[85]]$x,denObj2[[85]]$y,col='blue')
lines(denObj3[[85]]$x,denObj3[[85]]$y,col='gold')
lines(denObj4[[85]]$x,denObj4[[85]]$y,col='red')
plot(denObj1[[72]]$x,denObj1[[72]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=3',type='l')
lines(denObj2[[72]]$x,denObj2[[72]]$y,col='blue')
lines(denObj3[[72]]$x,denObj3[[72]]$y,col='gold')
lines(denObj4[[72]]$x,denObj4[[72]]$y,col='red')
plot(denObj1[[76]]$x,denObj1[[76]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[76]]$x,denObj2[[76]]$y,col='blue')
lines(denObj3[[76]]$x,denObj3[[76]]$y,col='gold')
lines(denObj4[[76]]$x,denObj4[[76]]$y,col='red')
plot(denObj1[[80]]$x,denObj1[[80]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[80]]$x,denObj2[[80]]$y,col='blue')
lines(denObj3[[80]]$x,denObj3[[80]]$y,col='gold')
lines(denObj4[[80]]$x,denObj4[[80]]$y,col='red')
plot(denObj1[[84]]$x,denObj1[[84]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[84]]$x,denObj2[[84]]$y,col='blue')
lines(denObj3[[84]]$x,denObj3[[84]]$y,col='gold')
lines(denObj4[[84]]$x,denObj4[[84]]$y,col='red')
plot(denObj1[[71]]$x,denObj1[[71]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='Duration=2',type='l')
lines(denObj2[[71]]$x,denObj2[[71]]$y,col='blue')
lines(denObj3[[71]]$x,denObj3[[71]]$y,col='gold')
lines(denObj4[[71]]$x,denObj4[[71]]$y,col='red')
plot(denObj1[[75]]$x,denObj1[[75]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[75]]$x,denObj2[[75]]$y,col='blue')
lines(denObj3[[75]]$x,denObj3[[75]]$y,col='gold')
lines(denObj4[[75]]$x,denObj4[[75]]$y,col='red')
plot(denObj1[[79]]$x,denObj1[[79]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[79]]$x,denObj2[[79]]$y,col='blue')
lines(denObj3[[79]]$x,denObj3[[79]]$y,col='gold')
lines(denObj4[[79]]$x,denObj4[[79]]$y,col='red')
plot(denObj1[[83]]$x,denObj1[[83]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='',ylab='',type='l')
lines(denObj2[[83]]$x,denObj2[[83]]$y,col='blue')
lines(denObj3[[83]]$x,denObj3[[83]]$y,col='gold')
lines(denObj4[[83]]$x,denObj4[[83]]$y,col='red')
plot(denObj1[[70]]$x,denObj1[[70]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=1',ylab='Duration=1',type='l')
lines(denObj2[[70]]$x,denObj2[[70]]$y,col='blue')
lines(denObj3[[70]]$x,denObj3[[70]]$y,col='gold')
lines(denObj4[[70]]$x,denObj4[[70]]$y,col='red')
plot(denObj1[[74]]$x,denObj1[[74]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=2',type='l')
lines(denObj2[[74]]$x,denObj2[[74]]$y,col='blue')
lines(denObj3[[74]]$x,denObj3[[74]]$y,col='gold')
lines(denObj4[[74]]$x,denObj4[[74]]$y,col='red')
plot(denObj1[[78]]$x,denObj1[[78]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=3',type='l')
lines(denObj2[[78]]$x,denObj2[[78]]$y,col='blue')
lines(denObj3[[78]]$x,denObj3[[78]]$y,col='gold')
lines(denObj4[[78]]$x,denObj4[[78]]$y,col='red')
plot(denObj1[[82]]$x,denObj1[[82]]$y,xlim=c(0,maxX),ylim=c(0,maxY),xlab='Intensity=4',type='l')
lines(denObj2[[82]]$x,denObj2[[82]]$y,col='blue')
lines(denObj3[[82]]$x,denObj3[[82]]$y,col='gold')
lines(denObj4[[82]]$x,denObj4[[82]]$y,col='red')
dev.off()

